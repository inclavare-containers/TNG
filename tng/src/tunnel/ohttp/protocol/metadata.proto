syntax = "proto3";

package tng.ohttp;

// Metadata for encrypted requests
// This represents the two cases for client authentication:
// 1. No client authentication required
// 2. Client authentication with asymmetric key
message Metadata {
  oneof metadata_type {
    // No client authentication required
    EncryptedWithoutClientAuth encrypted_without_client_auth = 1;
    
    // Client authentication required with asymmetric key
    EncryptedWithClientAuthAsymmetricKey encrypted_with_client_auth_asymmetric_key = 2;
  }
}

// Represents the case where no client authentication is required
message EncryptedWithoutClientAuth {
  // Empty message as there are no additional fields
}

// Represents the case where client authentication with asymmetric key is required
message EncryptedWithClientAuthAsymmetricKey {
  // The attestation result of the client, generated by an attestation service
  // This is used only in Server verification Client scenario
  string attestation_result = 1;

  // The client's public key, encoded in binary format
  // This is used only in Server verification Client scenario
  bytes pk_s = 2;
}